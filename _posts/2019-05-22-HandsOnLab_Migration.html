---
layout: post
title:  "Hands-On Lab 1"
subtitle: "AWS Migration (from Hyper-V) (1)"
date:   2019-05-22 16:00:00 -0400
background: '/img/posts/aws/Background.jpg'
---
<!-- 제목 + 설명 -->
<hr color="black" size="3">
<h2 class="section-heading" align="center">VM MIGREATION to AWS (1)</h2>
<p>
  <span style="color:#0063DC">
    <font size=4>
    On-Premise 환경에서 서비스 하던 서버를 AWS 플랫폼으로 가져오는 실습을 진행합니다.
    이번 POST에서는 마이그레이션 자체에 대한 LAB을 진행하고, 다음 POST에서는 모니터링에 대하여 다루게 됩니다.
    Server Migration에 대한 정확한 정보는 AWS 공식 홈페이지의 Document를 참고해야합니다.
    </font>
  </span>
</p>
<img class="img-fluid" src=\img\posts\aws\HOL1-1.JPG alt="Demo Image"> <br>
<span style="color:black">
  <font size=4>
    <strong>[목차] </strong> <br>
▶ Discovery<br>
1) Use AWS discovery tools<br>
2) View discovery servers<br>
3) Group Servers as applications<br>
<br>
▶ Migration<br>
4) Connect Migration tools to Migration Hub<br>
5) Migrate using the connected Migration tools<br>
<br>
▶ Track<br>
6) Track status of migrations<br>
  </font>
</span>
<br>
<hr color="black" size="3">
<br>

<!-- 본문 -->

<h4>● 테스트 환경 </h4>
<br>
<span style="color:black">
  <font size=4>
    Hyper-V IP: 13.209.210.224<br>
    Hyper-V ID/PW : sms11 / P@ssword1234<br>
    VM: web11 (hostname: web11.seoul, IP: 192.168.137.111)<br>
    SMS 설정정보:<br>
    &nbsp;&nbsp;1.AD user: Corp\sms11<br>
    &nbsp;&nbsp;2.SMS Connector IP: 192.168.137.211<br>
  </font>
</span>
<br>
<hr color="black" size="3">
<br>
<h4>● 사전 확인 </h4>
<br>
<span style="color:black">
  <font size=4>
    가상머신에서 웹 서버가 올바르게 동작하고 있는지 확인합니다.
    <img class="img-fluid" src=\img\posts\aws\HOL1-2.JPG alt="Demo Image"> <br>
    현재 Hyper-V 위에 동작하고있는 가상머신은 WEB 서비스를 정상적으로 운영하고 있습니다.
  </font>
</span>
<br>
<hr color="black" size="3">
<br>
<h4>● 사전작업 1) AWS IAM Role에 SMS Role 추가</h4>
<br>
<span style="color:black">
  <font size=4><strong>
    1. AWS 관리 콘솔에서 IAM 을 선택한 후 네비게이션에서 Roles 를 선택합니다. <br>
    2. Create role 버튼을 클릭합니다. <br>
    3. Create role 화면에서 Choose the service that will use this role 에서 SMS 를 선택한 후 Next: Permissions 를 클릭합니다. <br>
    4. “Attached permission policies” 화면에서 ServerMigrationServiceRole 을 확인 후 Next:Tags 를 클릭합니다. <br>
    5. Add Tags(optional) 화면에서 Nex:Review 를 클릭합니다. <br>
    6. 나머지 화면은 Default 로 나두고 Next 버튼을 클릭합니다. <br>
    7. Review 화면에서 Role Name 에 sms 를 입력한 후 Create role 버튼을 클릭합니다. <br>
    8. Roles 화면에서 sms 가 정상적으로 생성되었는지 확인합니다. <br>
    <img class="img-fluid" src=\img\posts\aws\HOL1-3.JPG alt="Demo Image"> <br>
  </strong></font>
</span>
<br>
<h4>● 사전작업 2) VM에 AWS ADS Agent 설치--s나중에 다시 ;;;;안깔림 curl</h4>
<br>
<span style="color:black">
  <font size=4>
    <strong>1. VM에 AWS ADS Agent를 다운받습니다.</strong><br>
    <font size="3" color="blue"># curl -o ./aws-discovery-agent.tar.gz https://s3-us-west2.amazonaws.com/aws-discovery-agent.us-west-2/linux/latest/aws-discoveryagent.tar.gz</font><br>
    <strong>2. VM에 다운받은 AWS ADS Agent의 압축을 풀고 설치합니다.</strong><br>
    <font size="3" color="blue">#tar -xzf aws-discovery-agent.tar.gz</font><br>
    <font size="3" color="blue"># bash install -r us-west-2 -k "AWS key id" -s "AWS key secret"</font><br>
  </font>
</span>
<br>
<hr color="black" size="3">
<br>
<h4>● 1. Hyper-V에 Server Migration Service Connector 다운로드 및 배포 </h4>
<br>
<span style="color:black">
  <font size=4>
    <strong>1. Hyper-V 호스트 서버에서 AWS-SMS-Connector-for-SCVMM-HyperV.zip 다운로드합니다.</strong><br>
    <font size="3" color="blue">https://s3.amazonaws.com/sms-connector/AWS-SMS-Connector-for-SCVMM-HyperV.zip</font><br>
    <strong>2. Hyper-V 호스트 서버에서 Connector Setup 합니다.</strong><br>
    &nbsp;&nbsp;2-1) AWS-SMS-Connector-for-SCVMM-HyperV.zip 파일을 압축 해제 합니다.<br>
    &nbsp;&nbsp;2-2) Windows Administrative Tools 폴더에 있는 Hyper-V Manager를 실행합니다.<br>
    &nbsp;&nbsp;2-3) Hyper-V Manager에서 "Import Virtual Machine"을 선택하여 압축해제 한 AWS-SMS-Connector-for-SCVMM-HyperV(VHD)를 가상머신으로 생성합니다.<br>
    &nbsp;&nbsp;2-4) 생성한 Connector는 "AWS-SMS-Connector"라는 이름으로 생성됩니다. 해당 가상머신을 더블클릭하여 콘솔창이 뜨면 "start"버튼을 눌러 가상머신을 시작합니다.<br>
    &nbsp;&nbsp;2-5) 가상머신이 시작되면, <strong>sudo setup.rb</strong> 명령어를 실행한 후 <strong>계정:ec2-user/암호:ec2pass</strong> 를 입력하여 로그인합니다.<br>
    &nbsp;&nbsp;2-6) 기본적으로 DHCP로 설정되어있습니다. 가상머신의 IP를 static IP로 변경합니다. 옵션2-옵션2-IP설정(통신가능한IP) <br>
  </font>
</span>
<br>
<hr color="black" size="3">
<br>
<h4>● 2. Hyper-V에 Configuration script 다운로드, 설치 및 실행 </h4>
<br>
<span style="color:black">
  <font size=4>
    <strong>1. Hyper-V에 Hyper-V Configuration Connector 스크립트를 다운로드 합니다.</strong><br>
    <font size="3" color="blue">https://s3.amazonaws.com/sms-connector/aws-sms-hyperv-setup.ps1</font><br>
    <strong>2. Windows Power Shell에 마우스를 댄 후 오른쪽 버튼을 클릭하여 "Run as administrator"를 선택하여 관리자 모드로 PowerShell을 실행합니다.</strong><br>
    <strong>3. 다운로드 한 스크립트를 실행합니다.</strong><br>
    <font size="3" color="blue">C:\Users\sms11\Downloads\/aws-sms-hyperv-setup.ps1</font><br>
    &nbsp;&nbsp;3-1) R을 눌러 실행한 후 1번을 선택합니다 <br>
    &nbsp;&nbsp;3-2) Connector IP에 위에 입력했던 Static IP를 입력합니다. <br>
    &nbsp;&nbsp;3-3)
    </font>
</span>
<br>
<hr color="black" size="3">
<br>

<!-- 댓글 -->
    <p>
      <div id="disqus_thread"></div>
      <script>
      /**
      *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
      *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
      /*
      var disqus_config = function () {
      this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      */
      (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://1mini2-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </p>
